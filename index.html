<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Master Simple Cloud</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        * { box-sizing: border-box; font-family: sans-serif; }
        body { background: #f0f2f5; margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        
        /* –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ */
        #auth-form { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 100%; max-width: 350px; margin-top: 50px; text-align: center; }
        input { width: 100%; padding: 12px; margin: 5px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 5px; }
        .login-btn { background: #222; color: white; }
        .reg-btn { background: none; color: #666; font-size: 14px; }

        /* –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–∞—Ç—Ä–∏—Ü—ã */
        #app { display: none; width: 100%; max-width: 800px; }
        .matrix { display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 15px; }
        @media (min-width: 600px) { .matrix { grid-template-columns: 1fr 1fr; } }
        .quadrant { background: white; padding: 15px; border-radius: 12px; border-top: 5px solid #333; }
        .item { background: #f9f9f9; padding: 8px; margin-top: 8px; border-radius: 8px; position: relative; border: 1px solid #eee; }
        .del { position: absolute; right: 5px; top: 5px; color: #ccc; border: none; background: none; cursor: pointer; }
        #loader { display: none; position: fixed; inset: 0; background: rgba(255,255,255,0.8); z-index: 100; align-items: center; justify-content: center; }
    </style>
</head>
<body>

<div id="loader">‚è≥ –°–µ–∫—É–Ω–¥—É...</div>

<div id="auth-form">
    <h3>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
    <input type="text" id="email" placeholder="–õ–æ–≥–∏–Ω (Email)">
    <input type="password" id="pass" placeholder="–ü–∞—Ä–æ–ª—å">
    <button class="btn login-btn" onclick="go('login')">–í–û–ô–¢–ò</button>
    <button class="btn reg-btn" onclick="go('reg')">–í–ø–µ—Ä–≤—ã–µ –∑–¥–µ—Å—å? –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
</div>

<div id="app">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <b>–ú–∞—Ç—Ä–∏—Ü–∞ Master</b>
        <button onclick="firebase.auth().signOut()" style="border:none; background:none; color:red; cursor:pointer;">–í—ã–π—Ç–∏</button>
    </div>

    <div class="matrix">
        <div class="quadrant" style="border-color: red;">
            <h4>üî• –°—Ä–æ—á–Ω–æ</h4>
            <div style="display:flex; gap:5px;">
                <input type="text" id="in1" placeholder="–¢–µ–∫—Å—Ç..." style="margin:0">
                <button onclick="document.getElementById('f1').click()">üìé</button>
                <input type="file" id="f1" style="display:none" onchange="up(1)">
                <button class="login-btn" style="width:40px; border-radius:8px;" onclick="add(1)">+</button>
            </div>
            <div id="l1"></div>
        </div>

        <div class="quadrant" style="border-color: blue;">
            <h4>üìÖ –í–∞–∂–Ω–æ</h4>
            <div style="display:flex; gap:5px;">
                <input type="text" id="in2" placeholder="–¢–µ–∫—Å—Ç..." style="margin:0">
                <button onclick="document.getElementById('f2').click()">üìé</button>
                <input type="file" id="f2" style="display:none" onchange="up(2)">
                <button class="login-btn" style="width:40px; border-radius:8px;" onclick="add(2)">+</button>
            </div>
            <div id="l2"></div>
        </div>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyAm7l3kLNaXW90TyN9gFS2pwfdseimErdc",
        authDomain: "fail-21187.firebaseapp.com",
        databaseURL: "https://fail-21187-default-rtdb.firebaseio.com",
        projectId: "fail-21187",
        appId: "1:621043286513:web:dc826eaa4ddebb5cc14450"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    auth.onAuthStateChanged(user => {
        document.getElementById('auth-form').style.display = user ? 'none' : 'block';
        document.getElementById('app').style.display = user ? 'block' : 'none';
        if(user) load(user.uid);
    });

    async function go(mode) {
        const e = document.getElementById('email').value;
        const p = document.getElementById('pass').value;
        try {
            if(mode === 'reg') await auth.createUserWithEmailAndPassword(e, p);
            else await auth.signInWithEmailAndPassword(e, p);
        } catch(err) { alert(err.message); }
    }

    function load(uid) {
        db.ref('users/' + uid).on('value', snap => {
            [1,2].forEach(i => document.getElementById('l'+i).innerHTML = '');
            snap.forEach(child => {
                const item = child.val();
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <div>${item.file ? 'üìÑ' : 'üìå'} ${item.text}</div>
                    <button class="del" onclick="db.ref('users/${uid}/${child.key}').remove()">‚úï</button>
                    ${item.file ? `<a href="${item.file}" download="${item.text}" style="font-size:12px; color:blue;">–°–∫–∞—á–∞—Ç—å</a>` : ''}
                `;
                document.getElementById('l'+item.q).prepend(div);
            });
        });
    }

    async function add(q) {
        const txt = document.getElementById('in'+q).value;
        if(txt) {
            await db.ref('users/' + auth.currentUser.uid).push({ q, text: txt });
            document.getElementById('in'+q).value = '';
        }
    }

    function up(q) {
        const file = document.getElementById('f'+q).files[0];
        if(!file) return;
        document.getElementById('loader').style.display = 'flex';
        const reader = new FileReader();
        reader.onload = async (e) => {
            await db.ref('users/' + auth.currentUser.uid).push({
                q, text: file.name, file: e.target.result
            });
            document.getElementById('loader').style.display = 'none';
        };
        reader.readAsDataURL(file);
    }
</script>
</body>
</html>
